<script>
    // Fetch data from Google Apps Script
    async function fetchData() {
        try {
            const response = await fetch('https://script.google.com/macros/s/AKfycbzz5MCC2s-GU4JWcDqLKj8pvrbW7w_QLED3J0nXY5qQrauJnxmFtHEvKVzhi_kcUdge/exec');
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
            const data = await response.json();
            return data;
        } catch (error) {
            console.error('Error fetching data:', error);
            return [];
        }
    }

    // Render Table Function
    function renderTable(data) {
        const tableBody = document.getElementById("tableBody");
        tableBody.innerHTML = data.map(item => `
            <tr>
                <td>${item.URL || ''}</td>
                <td>${item.Price || ''}</td>
                <td>${item.Description || ''}</td>
                <td>${item.Category || ''}</td>
                <td>${item.Availability || ''}</td>
            </tr>
        `).join("");
    }

    // Search Functionality
    function searchData() {
        const searchTerm = document.getElementById("searchInput").value.toLowerCase();
        fetchData().then(data => {
            const filteredData = data.filter(item => item.URL.toLowerCase().includes(searchTerm));
            renderTable(filteredData);
        });
    }

    // Initial Load
    fetchData().then(data => renderTable(data));
</script>
